# 宏观视角下的浏览器

## 浏览器多进程架构

* 浏览器进程：主要负责主界面显示，用户交互，子进程管理，同时提供存储功能
* 渲染进程：排版引擎和v8在该进程中运行，沙盒模式.
* gpu进程: gpu成为浏览器普遍追求
* 网络进程：网络资源加载
* 插件进程: 插件的运行
* 优点：稳定 流畅 安全 缺点：更多的资源占用 更复杂的体系架构

* Process-per-site-instance

## 导航流程

```
用户在浏览器输入信息
网络进程发起url请求
服务器响应url请求之后  浏览器进程开始准备渲染进程了
渲染进程接收完毕页面就加载页面和加载子资源

Url请求过程

总结
服务器根据响应头控制浏览器的行为如跳转 网络数据类型的判断
chorme默认采用每个标签对应一个渲染进程 但属于同一个站点则会采用同一个渲染进程
浏览器导航进程涵盖了从用户发起请求到提交文档给渲染进程的中间的所有阶段

```

## 渲染流程

* 渲染进程将 HTML 内容转换为能够读懂的DOM 树结构。

* 渲染引擎将 CSS 样式表转化为浏览器可以理解的styleSheets，计算出 DOM 节点的样式。

* 创建布局树，并计算元素的布局信息。

* 对布局树进行分层，并生成分层树。

* 为每个图层生成绘制列表，并将其提交到合成线程。

* 合成线程将图层分成图块，并在光栅化线程池中将图块转换成位图。

* 合成线程发送绘制图块命令DrawQuad给浏览器进程。

* 浏览器进程根据 DrawQuad 消息生成页面，并显示到显示器上